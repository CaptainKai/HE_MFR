2021-12-22 21:01:08,337: [('name', 'SResnet_split'), ('backbone_model_name', 'SimpleResnet_split_abla_36'), ('classify_model_name', 'MarginCosineProduct'), ('resume_net_model', None), ('resume_net_classifier', None), ('no_cuda', False), ('gpu_num', 1), ('log_interval', 100), ('log_path', './logs/SResnet_36_split_noDrop_noLA_b3_3loss_1_nomask.log'), ('log_pic_path', './logs/pic/SResnet_36_split_noDrop_noLA_b3_3loss_1_nomask/'), ('save_path', 'snapshot/SResnet_36_split_noDrop_noLA_b3_3loss_1_nomask/'), ('lmdb_path', '/home/ubuntu/data4/lk/data/lmdb_mask_augu_full'), ('batch_size', 512), ('datanum', 3923399), ('num_class', 86876), ('lmdb_workers', 4), ('num_workers', 4), ('start_epoch', 1), ('max_epoch', 26), ('lr', 0.1), ('base', 'epoch'), ('step_size', [10, 20, 30, 40, 50, 60]), ('momentum', 0.9), ('gama', 0.1), ('weight_decay', 0.0005), ('rank', -1), ('dist_url', 'env://'), ('world_size', -1), ('gpu', None), ('dist_backend', 'nccl'), ('distributed', False), ('master_port', 32345), ('multiprocessing_distributed', False), ('SEED', 1337), ('local_rank', -1)]
2021-12-22 21:01:08,337: SimpleResidual_split_abla(
  (conv1): ConvPrelu(
    (conv): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (prelu): PReLU(num_parameters=64)
  )
  (layer1): Sequential(
    (0): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=64)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=64)
      )
    )
    (1): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=64)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=64)
      )
    )
  )
  (conv2): ConvPrelu(
    (conv): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (prelu): PReLU(num_parameters=128)
  )
  (layer2): Sequential(
    (0): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
    )
    (1): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
    )
    (2): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
    )
    (3): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=128)
      )
    )
  )
  (conv3): ConvPrelu(
    (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (prelu): PReLU(num_parameters=256)
  )
  (layer3): Sequential(
    (0): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (1): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (2): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (3): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (4): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (5): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (6): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
    (7): SimpleResidualUnit(
      (conv1): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
      (conv2): ConvPrelu(
        (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=256)
      )
    )
  )
  (backbone): Sequential(
    (0): ConvPrelu(
      (conv): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (prelu): PReLU(num_parameters=64)
    )
    (1): Sequential(
      (0): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=64)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=64)
        )
      )
      (1): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=64)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=64)
        )
      )
    )
    (2): ConvPrelu(
      (conv): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (prelu): PReLU(num_parameters=128)
    )
    (3): Sequential(
      (0): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
      )
      (1): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
      )
      (2): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
      )
      (3): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=128)
        )
      )
    )
    (4): ConvPrelu(
      (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (prelu): PReLU(num_parameters=256)
    )
    (5): Sequential(
      (0): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (1): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (2): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (3): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (4): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (5): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (6): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
      (7): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=256)
        )
      )
    )
  )
  (SSS_up): SpaceSliceStrategy_subject(
    (layer4): Sequential(
      (0): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
      )
      (1): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
      )
    )
    (conv4): ConvPrelu(
      (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (prelu): PReLU(num_parameters=512)
    )
    (subject): ModuleList(
      (0): Sequential(
        (0): SimpleResidualUnit(
          (conv1): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
          (conv2): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
        )
        (1): SimpleResidualUnit(
          (conv1): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
          (conv2): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
        )
      )
      (1): ConvPrelu(
        (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=512)
      )
    )
  )
  (SSS_down): SpaceSliceStrategy_subject(
    (layer4): Sequential(
      (0): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
      )
      (1): SimpleResidualUnit(
        (conv1): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
        (conv2): ConvPrelu(
          (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (prelu): PReLU(num_parameters=512)
        )
      )
    )
    (conv4): ConvPrelu(
      (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (prelu): PReLU(num_parameters=512)
    )
    (subject): ModuleList(
      (0): Sequential(
        (0): SimpleResidualUnit(
          (conv1): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
          (conv2): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
        )
        (1): SimpleResidualUnit(
          (conv1): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
          (conv2): ConvPrelu(
            (conv): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (prelu): PReLU(num_parameters=512)
          )
        )
      )
      (1): ConvPrelu(
        (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (prelu): PReLU(num_parameters=512)
      )
    )
  )
  (fc_up): Linear(in_features=10752, out_features=256, bias=True)
  (fc_down): Linear(in_features=14336, out_features=256, bias=True)
)
2021-12-22 21:03:56,164: Use DP
2021-12-22 21:03:56,382: dataset:<dataprocess.lmdb_init.LMDB object at 0x7f9b62eacf98>
num:3923399
indexlist: ignore
format_transform:Compose(
    ToTensor()
    Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5))
)
preproc:None
ldm:False
ldm68:False
augu_rate:0.0
augu_paral:False
